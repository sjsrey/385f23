<h1>Introduction</h1>
<p>
<h3>Background.</h3>
<p>
If the background doesn't interest you, and you just want to get started with
Latexslides, jump to the 'Getting started' section.
<p>
For many people in the fields of natural sciences, LaTeX is the preferred
typesetting tool. Therefore, it didn't take long before different
packages where developed allowing people to also create slides with
LaTeX. Out of many, Prosper and Beamer are probably the best known. The most popular
package of these two is Prosper, while Beamer is the latest, the fanciest, and the most
PowerPoint-like package for LaTeX slides. Unfortunately, there is a lot of
LaTeX commands that you need to insert to make LaTeX slides. What if we could
just write the basic slide contents and insert a minimum of tags? That is, it
could be nice with a simpler syntax than what LaTeX slide packages require.
<p>
Another point is that it takes quite some boring work to update old
presentations, written in Prosper or even older syntax, to a new
package like Beamer. And what about the next super-package for LaTeX 
slides? It would be good if all your slides were written with a
LaTeX-independent syntax such that the slides can easily be ported
to a new (or old) format.
<p>
A third point is that sometimes we would like to automate the writing
of slides, for example when creating animations where several slides
with small differences are typically written by manual 
cut and paste operations. It would be better to have a program doing this.
<p>
From these points, it became natural to specify slides as program code
and automate the generation of the specific syntax for different
LaTeX packages. Our solution is Latexslides, which is written in Python
and requires you to write your slides in Python. Typically, each
slide is a <tt>Slide</tt> object, to which you assign a name, and then you
can collect the names in lists to compose a particular presentation.
It is easy to have your slides in modules such that new presentations
can import slides from other presentations. This gives great flexibility
in reusing slides from presentation to presentation without making a
copy of the slides. The LaTeX knowledge required from the end-user is also
less when using Latexslides than using plain LaTeX (then again, the Python
knowledge needed is much larger). But some of the advanced arguments to
Latexslides functions might still require a good LaTeX book.
<p>
Another important point is, of course, that whatever can be done in Python, 
should be done in Python :-) Also slides...
<p>
<p>
<h3>History.</h3>
<p>
Initially, <tt>LaTeXSlides</tt> was a module and script written by Hans Petter
Langtangen and later improved by Åsmund Ødegård, both at Simula Research 
Laboratory, Oslo, Norway. <tt>LaTeXSlides</tt> soon became quite popular as
it auto-generated both Beamer and Prosper slides from a minimum of
Python commands specifying the slides. However, <tt>LaTeXSlides</tt>
needed a complete redesign to better scale with future demands.
Arve Knudsen, also from Simula, started this effort, while this author
did the complete job of creating the new Latexslide package for
slide generation in Python. The old API of <tt>LaTeXSlides</tt> is still
supported for backward compatibility.
<p>
<h1>Getting started</h1>
<p>
<p>
<h3>Introductory example.</h3>
<p>
You can generate a new, empty presentation by typing
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
python -c 'import latexslides; latexslides.generate("myfile.py")'
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
Just invoke and edit the file <tt>myfile.py</tt>.
<p>
We will now look at a short example introducing the main functionalities of
Latexslides. We look at the source code of two slides, and the result for
Beamer can be viewed in the figures below. The first slide consists of two
parts, the left part contains a figure, and the right part contains some text
as well as a few lines of code, see Figures
<a href="#fig:intro1">fig:intro1</a> and <a href="#fig:intro2">fig:intro2</a>. The Python code used for generating these
slides is as follows:
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
from latexslides import *

author_and_inst = [("John Doe", "Royal University of Nothing")]

slides = BeamerSlides(title="Short Introduction",
                      titlepage=False,
                      toc_heading=None,
                      author_and_inst=author_and_inst,)

slide1 = Slide("Slide 1",
               content=[TextBlock(r"""
Program for computing the height of a ball thrown up in the air:
$y=v_0t- {1\over 2} gt^2$""") ,
                        Code(file='code.py')],
               figure='brainhurts.ps',
               figure_pos='w',
               figure_fraction_width=0.4,
               left_column_width=0.3,
               )

slide2 = BulletSlide("Slide 2",
                     ["Latexslides is flexible:",
                      ["One can create slides based on Python elements",
                       r"\LaTeX~code can be inserted directly in the code"],
                      "Latexslides means less code and less time used:",
                      ["The code is generated automatically",
                       r"One does not need to learn \LaTeX"],
                      "The package is easily installed by typing" +
                      Code("python setup.py install"),],
                     block_heading="Advantages of latexslides",
                     )
                     
collection = [slide1, slide2]
slides.add_slides(collection)

# Dump to file:
slides.write("intro.tex")

</pre></blockquote>
<! -- END VERBATIM BLOCK -->
Before dissecting each individual slide, we will take a look at the general layout
of this code. 
First, we need to import the Python module. Then, we define the parts of the
presentation that are common for all slides, including the name and
affiliation of the authors and the date. This is done by creating an instance
of one of the subclasses of <tt>Slides</tt>, meaning either <tt>BeamerSlides</tt>, <tt>ProsperSlides</tt>
or <tt>HTMLSlides</tt>, hereafter referred to as the main instance. Here we also
define what both the title page and the rest of the
presentation should look like, and how it should behave. The details on this
can be found further down in this tutorial. For this introductory example, we
have opted to show neither the title page nor the table of contents.  
<p>
The next
step is to define the objects that represent a slide. When we are finished
with all slides, we have to collect them and add them to the main instance in
the order we would like them to appear. Finally, we dump the whole
presentation to file.
<p>
Our first slide is a general <tt>Slide</tt> object. The title is set to "Slide 1", and
a figure is included on the slide. The figure is placed to the left of the
slide, and set not to exceed more than 3/10 of the slide. It also had to be
shrunk to 4/10 of its original size to fit on the slide. The right side of the
slide consists of two elements, a <tt>TextBlock</tt> and some code. It is worth
noticing that the Python code displayed on this slide is not part of the code
defining the slide. Rather, we give the <tt>Code</tt> class an argument <tt>file=code.py</tt>,
resulting in the Python code being read from the file <tt>code.py</tt>. Figure
<a href="#fig:intro1">fig:intro1</a> displays the first slide.
<p>
<img src="intro1.png"  > <p>
First slide of introductory example.  
<p>
The second slide is a <tt>BulletSlide</tt>, which is less general than the super class
<tt>Slide</tt>. This means that we have a less complicated interface at the cost of
flexibility. The bullets are lists of string elements, but nested lists are
allowed, as is shown. Finally, we opted to add a heading to the block making
up the bullets. If omitted, no heading is displayed. Figure <a href="#fig:intro2">fig:intro2</a>
displays the second slide.
<p>
<img src="intro2.png"  > <p>
Second slide of introductory example.
<p>
<p>
<h1>Documentation of the classes</h1>
<p>
<h3>Keyword arguments.</h3>
<p>
Objects in Latexslides makes heavily use of keyword arguments. This
means that when creating a new object, there are very few, if any,
arguments that are mandatory. A lot of arguments are optional, and will
be ignored if not present, or suitable default values will be used.
<p>
<h3>Initialization.</h3>
<p>
After an 
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
from latexslides import *
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
the first instance we need to create is
an instance of a subclass of the class <tt>Slides</tt>. This can be (at this time)
either <tt>ProsperSlides</tt>, <tt>BeamerSlides</tt> or <tt>HTMLSlides</tt>. The default values and
the Python data types for each keyword argument will be given below as
'Default' and 'Type'. If a keyword argument not works for all packages
(subclasses), the name of the packages for which it works for will be given as
well under 'Package'. Finally, necessary comments will be given under
'Comments'. It is worth noting the use of the keyword arguments <tt>n</tt>, <tt>s</tt>, <tt>e</tt>,
and <tt>w</tt>. These correspond to north, south, east, and west,
respectively. North indicates the top of a page, east the left of a page
etc. 
<p>
Here is a list of keyword arguments for the constructor of a <tt>Slide</tt> instance:

<ul>
 <li> <tt>title</tt>           

<ul>
   <li> Default: <tt>"Here goes the title of the talk"</tt>
   <li> Type: str
</ul>

 <li> <tt>author_and_inst</tt>

<ul>
   <li> Default: <tt>[('author1', 'inst1'), ('author2', 'inst2', 'inst3')]</tt>
   <li> Type: list of tuples of str
</ul>

 <li> <tt>date</tt>

<ul>
   <li> Default: <tt>None</tt>
   <li> Type: str
   <li> Comment: Today's date is chosen if not set.
</ul>

 <li> <tt>titlepage</tt>

<ul>
   <li> Default: <tt>True</tt>
   <li> Type: bool
   <li> Comment: If set to <tt>False</tt>, the title page is skipped.
</ul>

 <li> <tt>titlepage_figure</tt>

<ul>
   <li> Default: <tt>None</tt>
   <li> Type: str
   <li> Package: Beamer
   <li> Comment: Give name of figure file to appear on title page.
</ul>

 <li> <tt>titlepage_figure_pos</tt>

<ul>
   <li> Default: <tt>"s"</tt>
   <li> Type: str
   <li> Package: Beamer
   <li> Comments: Position of figure on the title page. Values can be either <tt>e</tt>, or <tt>s</tt>. Really, anything but <tt>s</tt> results in <tt>e</tt>.
</ul>

 <li> <tt>titlepage_figure_fraction_width</tt>

<ul>
   <li> Default: <tt>1.0</tt>
   <li> Type: float
   <li> Package: Beamer
   <li> Comment: Scales the picture, while keeping aspect ratio.
</ul>

 <li> <tt>titlepage_left_column_width</tt>

<ul>
   <li> Default: <tt>0.5</tt>
   <li> Type: float
   <li> Package: Beamer
   <li> Comment: If the figure is positioned to the left or right, two columns are used. This value sets the relative size of the left column, and should be between <tt>0</tt> and <tt>1</tt>. The size of the right column is 1 minus this value.
</ul>

 <li> <tt>short_title</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Package: Beamer 
   <li> Comment: This value, if present, is used instead of the main title if it is too large to fit somewhere in the presentation.
</ul>

 <li> <tt>short_author</tt>

<ul>
   <li> Default: <tt>None</tt>
   <li> Type: str
   <li> Package: Beamer
   <li> Comment: If the name of the authors(s) is too long to fit, this value, if present, is used instead. Else a string consisting of the first author's last name with 'et al.' added to it is used.
</ul>

 <li> <tt>copyright_text</tt>

<ul>
   <li> Default: <tt>None</tt>
   <li> Type: str
   <li> Package: Prosper
</ul>

 <li> <tt>toc_heading</tt>

<ul>
   <li> Default: <tt>"Outline"</tt>
   <li> Type: str
   <li> Package: Beamer
   <li> Comment: The heading of table of contents, shown between all sections and subsections. If set to <tt>None</tt> or an empty string, the table of contents is skipped. This might be preferable for shorter presentations.
</ul>

 <li> <tt>toc_figure</tt>

<ul>
   <li> Default: <tt>None</tt>
   <li> Type: str
   <li> Package: Beamer
   <li> Comment: Give name of file containing the figure to be shown on the table of contents slide.
</ul>

 <li> <tt>toc_figure_fraction_width</tt>

<ul>
   <li> Default: <tt>1.0</tt>
   <li> Type: float
   <li> Package: Beamer
   <li> Comment: Scales the picture, while keeping aspect ratio. 
</ul>

 <li> <tt>toc_left_column_width</tt>

<ul>
   <li> Default: <tt>0.5</tt>
   <li> Type: float
   <li> Package: Beamer
   <li> Comment: The figure is positioned to the left of the table of contents, hence two columns are used. This value sets the size of the left column, the size of the right column is 1 minus this value.
</ul>

 <li> <tt>colour</tt>

<ul>
   <li> Default: <tt>True</tt>
   <li> Type: bool
   <li> Comment: A <tt>False</tt> value makes the slides more suited for printing. Table of contents is dropped, and colours are removed from the background. Different behaviour for the different packages. Beamer forces the use of the theme <tt>seahorse</tt> when the value is <tt>False</tt>.
</ul>

 <li> <tt>handout</tt>

<ul>
   <li> Default: <tt>False</tt>
   <li> Type: bool
   <li> Package: Beamer
   <li> Comment: Makes the slides more suited for printing. The table of contents is dropped, and colours are removed from the background. Different behaviour for the different packages. The same as <tt>colour</tt>, but without <tt>seahorse</tt> as the forced colour theme.
</ul>

 <li> <tt>beamer_theme</tt>

<ul>
   <li> Default: <tt>"shadow"</tt>
   <li> Type: str
   <li> Package: Beamer
   <li> Comment: All default Beamer themes are available. In addition the themes <tt>simula</tt> and <tt>hpl1</tt> are included with the Latexslides package. Different themes might lead to different output. The use of <tt>simula</tt> or <tt>hpl1</tt> is recommended. Read more about styles in the section "Styles".
</ul>

 <li> <tt>beamer_colour_theme</tt>

<ul>
   <li> Default: <tt>"default"</tt>
   <li> Type: str
   <li> Package: Beamer
   <li> Comment: All default Beamer colour themes are available. For printing, the colour theme <tt>seahorse</tt> is recommended, as it is almost black and white. Take care not to use the <tt>simula</tt> theme with this one, as not all colours that are set there are overridden by this colour theme, resulting in some orange. If <tt>colour</tt> is set to <tt>False</tt>, this argument is overridden and the theme set to <tt>seahorse</tt>.
</ul>

 <li> <tt>prosper_style</tt>

<ul>
   <li> Default: <tt>"default"</tt>
   <li> Type: str
   <li> Package: Prosper
   <li> Comment: all default Prosper styles are available. In addition the style <tt>hplplainsmall</tt> is included with the Latexslides package. The use of <tt>hplplainsmall</tt> is recommended, as it matches the font sizes of the Beamer themes better, making it less likely for text not to fit on the slides when switching from Beamer to Prosper than with <tt>default</tt>.
</ul>

 <li> <tt>header_footer</tt>

<ul>
   <li> Default: <tt>True</tt>
   <li> Type: bool
   <li> Package: Beamer
   <li> Comment: Removes the top and bottom of the slide. On the top, the index over sections is removed, at the bottom the authors and title are removed. Theme dependent.
</ul>

 <li> <tt>html</tt>

<ul>
   <li> Default: <tt>False</tt>
   <li> Type: bool
   <li> Package: Beamer
   <li> Comment: This enables the possibility to dump the slides to HTML. Setting this variable to <tt>True</tt> and <tt>toc_heading</tt> to an empty string gives the same result as using HTMLSlides instead of BeamerSlides (HTMLSlides simply sets this variable to <tt>True</tt> and <tt>toc_heading</tt> to an empty string). Requires the package TeX4ht to be installed.
</ul>

 <li> <tt>newcommands</tt>

<ul>
   <li> Default: <tt>[]</tt>
   <li> Type: list or str
   <li> Comment: Adds the user's own commands to the top of the LaTeX file, useful because Latexslides supports raw LaTeX code. Can be given as a list of strings or a string separated by newline. Only <tt>\newcommand</tt> LaTeX commands can be given. The initial command (<tt>\newcommand</tt>) can be skipped.
</ul>

 <li> <tt>latexpackages</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: Adds additional packages to the list of packages at the beginning of the LaTeX file. In order to allow options to the packages, it is a simple multi-line string, e.g. the exact string otherwise written in the LaTeX file.
<p>
</ul>

</ul>
<h3>Adding slides.</h3>
<p>
After having created the <tt>BeamerSlides</tt> or <tt>ProsperSlides</tt> object,
we are ready to start creating individual slides. 
There are five types of slides:

<ul>
 <li> <tt>TextSlide</tt>
 <li> <tt>BulletSlide</tt>
 <li> <tt>Rawslide</tt>
 <li> <tt>TableSlide</tt>
 <li> <tt>Slide</tt>
</ul>

The last one can consist of several objects, whereas the first four slides are
meant for plain text, plain bullet lists, creation of LaTeX tables based on
Python lists, or plain LaTeX, respectively. For these, blocks are used when available.
<p>
<tt>TextSlide</tt> has the following keyword arguments:

<ul>
 <li> <tt>title</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: When empty string is given, no title is displayed.
</ul>

 <li> <tt>text</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: The text to be placed on the slide.
</ul>

 <li> <tt>block_heading</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: Additional title for the block. When empty string is given, no title is displayed.
</ul>

 <li> <tt>hidden</tt>

<ul>
   <li> Default: <tt>False</tt>
   <li> Type: bool
   <li> Comment: If <tt>True</tt>, the slide is skipped. The properties <tt>hide</tt> and <tt>unhide</tt> can also be used, and will return the slide element itself, see the sections 'Organizing the objects' and 'Writing to file' further down.
<p>
</ul>

</ul>

<tt>BulletSlide</tt> has four keyword arguments:

<ul>
 <li> <tt>title</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: When empty string is given, no title is displayed.
</ul>

 <li> <tt>bullets</tt>

<ul>
   <li> Default: <tt>[]</tt>
   <li> Type: list of strings
   <li> Comment: Each element in the list represents a bullet. The list can be nested, so that if one of the elements of the main list is a list, the items in that list will show up as sub-bullets.
</ul>

 <li> <tt>block_heading</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: Additional title for the block. When empty string is given, no title is displayed.
</ul>

 <li> <tt>hidden</tt>

<ul>
   <li> Default: <tt>False</tt>
   <li> Type: bool
   <li> Comment: If <tt>True</tt>, the slide is skipped.
</ul>

 <li> <tt>dim</tt>

<ul>
   <li> Default: <tt>None</tt>
   <li> Type: str
   <li> Package: Beamer
   <li> Comment: Available dimming settings are: <tt>progressive</tt> (one by one bullet), <tt>single</tt> (only one bullet at the time), <tt>single_then_all</tt> (only one bullet at the time, then all), and <tt>blocks</tt> (one block at the time, not relevant for <tt>BulletSlide</tt>).
<p>
</ul>

</ul>

<tt>RawSlide</tt> has two keyword arguments:

<ul>
 <li> <tt>rawtext</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: Enables the user to design her own slide using LaTeX commands directly. For example, one can include pure LaTeX code from old presentations. One should ensure that the string is a raw string preserving backslash and the like. If this class is used, changing between the different packages (e.g. Beamer and Prosper) would no longer be possible, as the code for these two differ quite a bit. As <tt>HTMLSlides</tt> is compatible with <tt>BeamerSlides</tt> these two, however, can still be interchanged.
</ul>

 <li> <tt>hidden</tt>

<ul>
   <li> Default: <tt>False</tt>
   <li> Type: bool
   <li> Comment: If <tt>True</tt>, the slide is skipped.
<p>
</ul>

</ul>

<tt>TableSlide</tt> enables the generation of LaTeX tables based on nested Python lists, and has seven keyword arguments:

<ul>
<li> <tt>title</tt>

<ul>
  <li> Default: <tt>""</tt>
  <li> Type: str
  <li> Comment: When empty string is given, no title is displayed.
</ul>

<li> <tt>table</tt>:

<ul>
  <li> Default: <tt>[[],[]]</tt>
  <li> Type: Nested list of strings
  <li> Comment: The first entry in the outer list should contain the column heading for the LaTeX table to be generated. The remaining entries are the lines in the table. See also the documentation of <tt>Table</tt> further down.
</ul>

<li> <tt>column_heading_pos</tt>

<ul>
   <li> Default: <tt>"c"</tt>
   <li> Type: str
   <li> Comment: See documentation of <tt>Table</tt>.
</ul>

<li> <tt>column_pos</tt>

<ul>
   <li> Default: <tt>"c"</tt>
   <li> Type: str
   <li> Comment: See documentation of <tt>Table</tt>.
</ul>

<li> <tt>center</tt>

<ul>
   <li> Default: <tt>False</tt>
   <li> Type: bool
   <li> Comment: See documentation of <tt>Table</tt>.
</ul>

<li> <tt>block_heading</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: Additional title for the block. When empty string is given, no title is displayed.
</ul>

 <li> <tt>hidden</tt>

<ul>
   <li> Default: <tt>False</tt>
   <li> Type: bool
   <li> Comment: If <tt>True</tt>, the slide is skipped.
<p>
</ul>

</ul>
<h3>Slide.</h3>
<p>
A general slide can consist of several
objects, and we will look at them now:

<ul>
 <li> <tt>Text</tt>
 <li> <tt>BulletList</tt>
 <li> <tt>Code</tt>
 <li> <tt>Table</tt>
 <li> <tt>Block</tt>
 <li> <tt>TextBlock</tt>
 <li> <tt>BulletBlock</tt>
 <li> <tt>CodeBlock</tt>
 <li> <tt>TableBlock</tt>
</ul>

The difference between a plain object (like <tt>BulletList</tt>) and a block object
(like <tt>BulletBlock</tt>), is that the
latter is surrounded by a shadowed box (depending on the slide format,
Beamer or Prosper, for instance), and has an optional heading for that
box. 
<p>
<tt>Text</tt> takes only one argument, and that is the text.
<p>
<tt>BulletList</tt> has <tt>bullets</tt> as argument and <tt>dim</tt> as keyword argument:

<ul>
 <li> <tt>bullets</tt>

<ul>
   <li> Default: <tt>[]</tt>
   <li> Type: list of strings
   <li> Comment: Each element in the list represents a bullet. The list can be nested, so that if one of the elements of the main list is a list, the items in that list will show up as sub-bullets.
</ul>

 <li> <tt>dim</tt>

<ul>
   <li> Default: <tt>True</tt>
   <li> Type: bool
   <li> Package: Beamer
   <li> Comment: This one is only used to override dimming if dimming is turned on for the whole slide, so that the whole block is displayed at once even though the rest of the bullet objects on the slide appear one by one.
<p>
</ul>

</ul>

<tt>Code</tt> has a number of keyword arguments, mainly because it supports the
option of reading the code from a file, or even only reading the text in between
a start and a stop expression:

<ul>
 <li> <tt>code</tt>

<ul>
   <li> Default: <tt>None</tt>
   <li> Type: str
   <li> Comment: The code to be inserted. Is ignored if reading from file is chosen.
</ul>

 <li> <tt>file</tt>

<ul>
   <li> Default: <tt>None</tt>
   <li> Type: str
   <li> Comment: The name of the file to include code from. If <tt>from_regex</tt> or <tt>to_regex</tt> is not set, the whole file is included.
</ul>

 <li> <tt>from_regex</tt>

<ul>
   <li> Default: <tt>None</tt>
   <li> Type: str
   <li> Comment: Can only be used if <tt>to_regex</tt> is set as well. The file in inspected line for line, and if the regular expression matches, that line is included. All further lines are then included, until there is a match for <tt>to_regex</tt>. The line that matches <tt>to_regex</tt> itself is not included.
</ul>

 <li> <tt>to_regex</tt>

<ul>
   <li> Default: <tt>None</tt>
   <li> Type: str
   <li> Comment: See <tt>from_regex</tt>
</ul>

 <li> <tt>leftmargin</tt>

<ul>
   <li> Default: <tt>"7mm"</tt>
   <li> Type: str
   <li> Comment: Sets the left margin for the code.
</ul>

 <li> <tt>fontsize</tt>

<ul>
   <li> Default: <tt>"footnotesize"</tt> (if the string does not start with a backslash, it is added automatically).
   <li> Type: str
   <li> Comment: Sets the size of the code font. Needs to be a valid LaTeX command ranging from <tt>tiny</tt> to <tt>Huge</tt> (if the string does not start with a backslash, it as added automatically).
<p>
</ul>

</ul>

<tt>Table</tt> gives us the possibility for creating LaTeX tables directly based on
(nested) Python lists. Writing tables in LaTeX is a tedious task, so automatically generating
it based on the Python lists saves us the effort of having to do it
manually. Also, if we need to make changes to our table, we can simply change
the Python lists, as the LaTeX table is built over again every time we run Latexslides.
<tt>Table</tt> has <tt>table</tt> as argument in addition to two keyword arguments:

<ul>
 <li> <tt>table</tt>

<ul>
   <li> Default: <tt>[[],[]]</tt>
   <li> Type: Nested list of strings
   <li> Comment: The first entry in the main list will be column headlines. The next entries in the list are the rows following the headline. All nested lists (i.e. each element in the main list) should have the same length. For example: <tt>table=[[r"$h$", r"$\Omega$", "n"], [0.1, 0.001, 100]]</tt>. If an element encountered in one of the sub-lists is not a string, the class will try to cast it to a string.
</ul>

 <li> <tt>column_headline_pos</tt>

<ul>
   <li> Default: <tt>"c"</tt>
   <li> Type: str
   <li> Comment: The position of the columns for the headline row, valid values are <tt>l</tt>, <tt>c</tt>, and <tt>r</tt> for left, center, and right, respectively. If only a single character, it is the same for every column. Else, the characters in the string are used one-by-one for every column. For instance, the string <tt>crl</tt> would mean that the first headline column is centered, the second one right justified, and the third one left justified. Unless omitted or given as a string with length one, it should be the same length as the numbers of columns.
</ul>

 <li> <tt>column_pos</tt>

<ul>
   <li> Default: <tt>"c"</tt>
   <li> Type: str
   <li> Comment: The position of the text for each column. If only a single character, it is the same for every column. Else, the characters in the string are used one-by-one for every column. For instance, the string <tt>crl</tt> would mean that the first ordinary column (not he headline) is centered, the second one right justified, and the third one left justified. Unless omitted or given with length one, it should be the same length as the numbers of columns given.
<p>
</ul>

</ul>

<tt>Block</tt> allows for the creation of block object consisting of a combination
of the three previous types (<tt>Text</tt>, <tt>BulletList</tt>, and <tt>Code</tt>). Hence it is more
general than the three block objects that follow:

<ul>
 <li> <tt>heading</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: If given, used as block title.
</ul>

 <li> <tt>content</tt>

<ul>
   <li> Default: <tt>[]</tt>
   <li> Type: list
   <li> Comment:  All objects to be placed within the block are sent as a list.
<p>
</ul>

</ul>

<tt>TextBlock</tt> is the same as <tt>Text</tt>, but has an additional keyword argument:

<ul>
 <li> <tt>heading</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: If given, used as block title.
<p>
</ul>

</ul>

<tt>BulletBlock</tt> is the same as <tt>BulletList</tt>, but has an additional keyword argument:

<ul>
 <li> <tt>heading</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: If given, used as block title.
<p>
</ul>

</ul>

<tt>CodeBlock</tt> is the same as <tt>Code</tt>, but has an additional keyword argument:

<ul>
 <li> <tt>heading</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: If given, used as block title.
<p>
</ul>

</ul>

<tt>TableBlock</tt> is the same as <tt>Table</tt>, but has these additional keyword arguments:

<ul>
 <li> <tt>heading</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: If given, used as block title.
</ul>

 <li> <tt>center</tt>

<ul>
   <li> Default: <tt>False</tt>
   <li> Type: bool
   <li> Comment: If <tt>True</tt>, center the table within the block.
<p>
</ul>

</ul>
<h5>Creating the slide instance</h5>
<p>
Once we have all the objects we want a slide to consist of, we can create the
slide instance itself. All arguments are keyword arguments:

<ul>
 <li> <tt>title</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: When empty string is given, no title is displayed.
</ul>

 <li> <tt>content</tt>

<ul>
   <li> Default: <tt>[]</tt>
   <li> Type: list
   <li> Comment: All objects to be placed on the slide are sent as a list.
</ul>

 <li> <tt>figure</tt>

<ul>
   <li> Default: <tt>None</tt>
   <li> Type: str or tuple of str
   <li> Comment: Give name of file or tuple of file names.
</ul>

 <li> <tt>figure_pos</tt>

<ul>
   <li> Default: <tt>s</tt>
   <li> Type: str
   <li> Comments: Figure can be placed north (<tt>n</tt>), east (<tt>e</tt>), south (<tt>s</tt>), and west (<tt>w</tt>) on the slide. The same for all figures.
</ul>

 <li> <tt>figure_fraction_width</tt>

<ul>
   <li> Default: <tt>1.0</tt>
   <li> Type: float
   <li> Comment: Scales the picture, keeps aspect ratio. <tt>figure_size</tt> can be used as well. In case both options are given, <tt>figure_size</tt> is chosen. If multiple figures are given with figure, the length of this argument is expected to be the same as the number of figures, or else the program exits with an error. The exception is if the length of the argument is 1 (or it is omitted), then this value (or the default of 1) will be used for all figures.
</ul>

 <li> <tt>figure_angle</tt>

<ul>
   <li> Default: <tt>None</tt>
   <li> Type: int or str
   <li> Comment: Give angle in degrees in the counter-clockwise direction to rotate image. Negative values can be used. The same for all figures.
</ul>

 <li> <tt>left_column_width</tt>

<ul>
   <li> Default: <tt>0.5</tt>
   <li> Type: float
   <li> Comment: If the figure is positioned to the left or right, two columns are used. This value sets the size of the left column, the size of the right column is 1 minus this value. 
</ul>

 <li> <tt>hidden</tt>

<ul>
   <li> Default: <tt>False</tt>
   <li> Type: bool
   <li> Comment: If <tt>True</tt>, the slide is skipped.
</ul>

 <li> <tt>dim</tt>

<ul>
   <li> Default: <tt>None</tt>
   <li> Type: str
   <li> Package: Beamer
   <li> Comment: Available dimming settings are: <tt>progressive</tt> (one by one bullet), <tt>single</tt> (only one bullet at the time), <tt>single_then_all</tt> (only one bullet at the time, then all), and <tt>blocks</tt> (one block at the time). Sub-items will always be shown together with their parent. If a specific block has the option <tt>dim</tt> set to <tt>False</tt>, the <tt>dim</tt> option for the slide is overridden. Setting <tt>dim</tt> for a block to <tt>False</tt> should only be used with <tt>progressive</tt>, as adding something to a slide that is not part of a block, can cuase the result to be unsatisfactory.
<p>
</ul>

</ul>
<h3>Adding sections.</h3>
<p>
One can insert special slides to mark sections in the talk. The section slides
will automatically appear in a table of contents and optionally in the header in Beamer
(but not in Prosper).
Sections are added in the same way as normal slides, except they are of
type <tt>Section</tt>. If no section is defined, normal slides are simply added to a
list of slides. If a section is defined, all slides added after that object
will be part of this section, until a new section is defined. It has two
keyword arguments:

<ul>
 <li> <tt>title</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: The title of the section
</ul>

 <li> <tt>short_title</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: Used when there is no space for the main title, for instance in the header.
<p>
</ul>

</ul>
<h3>Adding subsections.</h3>
<p>
Class <tt>SubSection</tt> is added in the same way as <tt>Section</tt>. If a subsection
is added before a section is added, an error is issued and the generation of
slides terminated. If a subsection is defined, all slides added after that object
will be part of this subsection, until a new section or subsection is
defined. It has two keyword arguments:

<ul>
 <li> <tt>title</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: The title of the section
</ul>

 <li> <tt>short_title</tt>

<ul>
   <li> Default: <tt>""</tt>
   <li> Type: str
   <li> Comment: Used when there is no space for the main title, for instance in the header.
<p>
</ul>

</ul>
<h3>Organizing the objects.</h3>
<p>
Instead of creating a slide and adding it immediately to the initial <tt>Slides</tt>
object using the the function <tt>add_slide</tt> in <tt>Slides</tt>, it might be better to
generate all the slide objects, and then add all the slides at the end of the
file. This way, it is easier to change the order of the slides. This is done
in both the introductory example and the <tt>exampletalk.py</tt> script. One can
either use a `for`-loop and call the function <tt>add_slide</tt> for each element in
the list, or call the function <tt>add_slides</tt> which takes the whole list as
argument. If the presentation exists of the objects <tt>slide1</tt>, <tt>section1</tt>,
<tt>slide2</tt>, <tt>subsection1</tt>, <tt>slide3</tt>, one can add all those to a list at the end
of the presentation. If <tt>slides</tt> is the initial <tt>Slide</tt> object, and
<tt>collection</tt> is a list of slides, one can use any of the two following ways of
adding the slides in the list to the <tt>slides</tt> object:
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
for slide in collection:
    slides.add_slide(slide)
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
or
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
slides.add_slides(collection)
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
The list of slide objects can be generated automatically, more about this in
the next section.
<p>
<h1>Additional scripts</h1>
<p>
<h3>Naming slide objects.</h3>
<p>
The slide object that one creates need to be stored in a Python variable, and
instead of naming these object <tt>slide1</tt>, <tt>slide2</tt> etc. it would be preferable
to name them according to the slide title. When writing many slides, it would
be easier to just create the slide objects without naming them, and to run a
script to automatically name these objects when finished. The executable
<tt>create_slidenames</tt> which is part of Latexslides does exactly that. Running
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
create_slidenames exampletalk.py
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
means the script searches the given file for lines starting with <tt>= Slide</tt>, 
<tt>= Section</tt>, or <tt>= SubSection</tt>, and adds a line consisting of the title of the
slide before these lines. Special characters as well as spaces and Norwegian
characters are substituted so the variable name is valid in Python. Spaces
and the character <tt>'='</tt> are substituted by underscores, Norwegian characters are
substituted by plain ASCII letters (\o~by o, \aa~by aa and \ae~by ae), and
other characters are simply removed.
<p>
Let's look at an example. The line
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
= BulletSlide('Character test !"#%&/()[]^ØÆÅ',)
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
becomes
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
Character_test_OAEAA \
= BulletSlide('Character test !"#%&/()[]^ØÆÅ',)
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
and the line
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
= Section('More about {if "__name__" == __main__}',)
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
becomes
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
More_about_if___name________main__ \
= Section('More about {if "__name__" == __main__}',)
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
In this way, we don't need to worry about naming the Python objects. Note that
one needs to use the exact same syntax, i.e. starting a line with the
character <tt>'='</tt> followed by the name of the class to be used. The space
between those two can be skipped. Also note that the created name of the
object does not change automatically if the title is changed. When running,
the script examines the previous line to see if we already have assigned the
instance to a variable name, and if so, nothing is done. In this way, running
the script several times should not result in multiple declarations of the
variable name, however, this also results in the variable name not being
updated when the title of the slide or section is changed. Deleting the line
containing the variable name and running the script again should fix this. Any
instance that already has a variable assigned to it manually on the same line,
for instance when writing <tt>myslide = Slide('This is the title',)</tt>, is also
skipped. This script changes the actual file, however a backup is made with
the extension <tt>.old~~</tt>, so running
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
create_slidenames exampletalk.py
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
would result in <tt>exampletalk.py</tt> now containing the variable names as well,
whereas <tt>exampletalk.py.old~~</tt> would contain the original file.
<p>
<h3>Extracting slide names.</h3>
<p>
Once you are finished writing the talk you need to add all the slide objects
to the main instance of the <tt>Slides</tt> class used (e.g. <tt>BeamerSlides</tt>). The
easiest way of keeping an overview is to do this at the end of the Python
file, rather then after creating each slide, as discussed in the previous
section. We included a script for extracting the variable names of all slides
in the file in the script <tt>extract_slidenames</tt>. It runs through the file
scanning for the variable names, and prints out a Python list in the terminal
that can be copied directly in the the bottom of the Python file. So when
running
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
extract_slidenames exampletalk.py
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
the file <tt>exampletalk.py</tt> remains the same. Instead of copying the test we
could add the list to the bottom of the file automatically:
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
extract_slidenames exampletalk.py >> exampletalk.py
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
Note that if we add or remove slides, we need to regenerate this list.
<p>
<h3>Converting talks to the OpenOffice format.</h3>
<p>
Another script that comes as part of Latexslides is <tt>pdf2odp</tt>. It is used for
converting PDF files in general to a format recognized by OpenOffice. This
script is described in more detail in the section 'Using talks in OpenOffice'
further down.
<p>
<h1>Writing to file</h1>
<p>
When finished writing the presentation, we can dump the LaTeX code to
file. This is done by simply calling the function <tt>write</tt> for the initial <tt>Slides</tt>
object (of class <tt>BeamerSlides</tt>, <tt>ProsperSlides</tt> etc.). The argument is the
file name. The <tt>write</tt> function also outputs the necessary commands one needs
to run for creating the slides for the specific package used (Prosper, Beamer,
HTML). So if all slide instances are collected in a list <tt>collection</tt>, these
are dumped to file by writing
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
for c in collection:
    slides.add_slide(c)
filename = 'mytalk.tex'
slides.write(filename)
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
or (even simpler)
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
slides.add_slides(collection)
filename = 'mytalk.tex'
slides.write(filename)
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
If there are some slides that you do not want to be part of the presentation,
you do not have to delete them. You can either remove the slides you do not
want to include from the list, or even simpler, mark them as hidden. This can
be done in three ways.

<ol>
<li> Set the keyword argument <tt>hidden</tt> to <tt>True</tt> when creating the slide.
<li> Set the attribute <tt>hidden</tt> to <tt>True</tt>. If you slide instance is called <tt>titleslide</tt>, it will not be printed if you write <tt>titleslide.hidden=True</tt>.
<li> Add the property <tt>hide</tt> to an object when adding it. It returns the object with the attribute <tt>hidden</tt> set to <tt>True</tt>. So instead of writing
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
slides.add_slide(titleslide)
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
</ol>

you would write
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
slides.add_slide(titleslide.hide)
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
<p>
<h1>Compiling the talk</h1>
<p>
If the function <tt>slides.write()</tt> is used, the necessary commands for compiling
the talk are
output to screen. If not, one simply uses <tt>latex mytalk.tex</tt>. Please note
that the generation of HTML slides requires running <tt>tex4ht</tt> and <tt>t4ht</tt> afterwards.
<p>
<h1>About figure support</h1>
<p>
Because Prosper cannot be used with <tt>pdflatex</tt>, <tt>latex</tt> is recommended. This
means, however, that only .ps images can be used, not .png, if portability
between Prosper and Beamer is desirable. It is recommended that you use the
ImageMagick <tt>convert</tt> tool for converting the PNG image to PostScript, and including them as
.ps or .eps files.
<p>
<h1>Using talks in OpenOffice</h1>
<p>
Latexslides includes a script for converting presentations in the PDF format
to the OpenOffice Impress format (.odp). OpenOffice Impress is a presentation
tool similar to Microsoft Office PowerPoint. OpenOffice is a free, open source
alternative to Microsoft Office. One could convert the .odp file further to a
PowerPoint file (.ppt), either by opening it in Impress and opting to save it
as a .ppt file, or through a commandline script like 
<a href="http://www.artofsolving.com/opensource/pyodconverter">PyODConverter</a>
(<a href="http://www.artofsolving.com/opensource/pyodconverter">http://www.artofsolving.com/opensource/pyodconverter</a>). 
<p>
Sometimes
when  giving a presentation, you might experience that the organizers only
accept .ppt or .odp files. <tt>pdf2odp</tt>, which comes as part of Latexslides,
solves this problem. Of course, not
accepting PDF files these days would be surprising, and hence this is not the
main objective of the script. The reason it was written is that sometimes,
one might want to add a few extras to the presentation. For instance, one
could highlight certain words by adding a circle, drawing some arrows, or one
could use
some of the advanced possibilities provided by presentation tools
like Impress and PowerPoint without having to write the whole presentation
with this tool, something that we already agreed upon can be rather
tedious. In this way, we can combine the best from two worlds; the simplicity
of Latexslides and the advanced interactive functionality of Impress or PowerPoint.
<p>
The script <tt>pdf2odp</tt> uses a Python module called <tt>odfpy</tt>. An error is given before
exiting the script in case this module is unavailable. If the module is found,
Ghostscript is used for converting the input file, which should be a PDF
file, to a set of PNG files, one for each page in the input file. This
conversion process can take some time. If Ghostscript is unavailable, the
script will exit with an error. When the conversion is finished, <tt>odfpy</tt> is
used to create the OpenOffice file. Each slide in the new presentation contains an
image that corresponds to the slide in the input file, and this image covers
the whole slide. Finally, the OpenOffice file is saved and the scripts exits.
<p>
As the slides from the original PDF file merely are images in the new .odp
file, we loose some of the functionality from the PDF file, mainly the
linking within the document. With Beamer, for instance, there are links in the
presentation allowing one to navigate within the slides. These links will now
simply be part of the image, and cannot be clicked. Also, as all the text is
part of an image, it is no longer possible to copy the text or index the file
in any way.
<p>
<h1>Package specifics</h1>
<p>
<h3>ProsperSlides.</h3>
<p>
Some of the keyword arguments are only available to BeamerSlides and
HTMLSlides. If these keyword arguments are present when using ProsperSlides,
they are simply ignored.
<p>
<h3>HTMLSlides.</h3>
<p>
HTMLSlides is really the same as BeamerSlides, with the following modifications:

<ul>
 <li> The <tt>html</tt> keyword for Slides is set to <tt>True</tt>.
 <li> The <tt>toc_heading</tt> keyword for Slides is set to en empty string, removing the table of contents.
 <li> All sections and subsections are removed.
</ul>

After Latexslides has generated the LaTeX code, the commands <tt>tex4ht</tt> and
<tt>t4ht</tt> are used to generate the actual HTML file.
<p>
<h1>Styles</h1>
<p>
Several LaTeX styles are included with this package. These are:

<ul>
 <li> beamerthemsimula.sty
 <li> beamerthemehpl1.sty
</ul>

for Beamer and:

<ul>
 <li> PPRhplplain.sty
 <li> PPRhplplain2.sty
 <li> PPRhplplainsmall.sty
</ul>

for Prosper. These are located in the folder <tt>styles</tt>. If you want to use
these, you might want to set the following in your shell start-up file (for
Bash, this is <tt>~/.bashrc</tt>:
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
export TEXINPUTS=:.:/absolute/path/to/styles
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
Note the first <tt>'.'</tt>; it ensures that the system-wide directories are
searched first. More information on how to install the style files to the
correct directories is found in the README file.
<p>
<h1>Emacs bindings</h1>
<p>
The following Emacs command (Alt + up-arrow) starts a slide object
without a variable name:
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
(global-set-key [ (meta up)] " = Slide('',
content=[BulletBlock(bullets=[
    '',")
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
Bullet points can then be written.
The end of the <tt>Slide</tt> object is automatically generated by
this Emacs command (Alt + down-arrow):
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
(global-set-key [ (meta down)] "
]),  # end bullets and BulletBlock
],   # end contents
)")
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
In order for these to work, the commands need to be included in the file
<tt>.emacs</tt> in your home directory. Sorry, no vim bindings!
<p>
<h1>Oldlatexslides</h1>
<p>
The source code from the old <tt>LaTeXSlides</tt> package can still be used. However it
needs a few modifications. We start by importing the module:
<!-- BEGIN VERBATIM BLOCK   -->
<blockquote><pre>
import latexslides.old as LaTeXSlides
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
Here, we assume that the import statement in
your old presentations was\\ <tt>import LaTeXSlides</tt>, not 
<tt>from LaTeXSlides import *</tt>. If you used the latter, you might want to try 
<!-- BEGIN VERBATIM BLOCK  -->
<blockquote><pre>
from latexslides.old import *
</pre></blockquote>
<! -- END VERBATIM BLOCK -->
The only difference is that the header, titlepage, and footer objects are to be
omitted, meaning they should not be part of the list that is created at the
end of the talk. Finally, the <tt>header_footer</tt> argument that was used for each
bullet-slide in the old package is now a global variable set in the
initialization of the main slides class, and is the same for all slides.
<p>
<h1>Support</h1>
<p>
Please contact <tt>ilmarw@simula.no</tt> for bug reports, feature requests and
general help.

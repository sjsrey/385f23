<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Geog385F23 – quarto-input4bb7553e</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Geog385F23</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../syllabus.html">Syllabus</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../lectures">Lectures</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#geopandas" id="toc-geopandas" class="nav-link active" data-scroll-target="#geopandas">GeoPandas</a>
  <ul class="collapse">
  <li><a href="#geometry" id="toc-geometry" class="nav-link" data-scroll-target="#geometry">Geometry</a></li>
  <li><a href="#centroids-and-geometry" id="toc-centroids-and-geometry" class="nav-link" data-scroll-target="#centroids-and-geometry">Centroids and geometry</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="geopandas" class="level1">
<h1>GeoPandas</h1>
<ul>
<li>GeoPandas Structure</li>
<li>Working with GeoDataFrames and GeoSeriesf</li>
<li>Carrying out project</li>
<li>Basic spatial queries and attribute construction</li>
</ul>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_2579345/1616829109.py:1: DeprecationWarning: Shapely 2.0 is installed, but because PyGEOS is also installed, GeoPandas still uses PyGEOS by default. However, starting with version 0.14, the default will switch to Shapely. To force to use Shapely 2.0 now, you can either uninstall PyGEOS or set the environment variable USE_PYGEOS=0. You can do this before starting the Python process, or in your code before importing geopandas:

import os
os.environ['USE_PYGEOS'] = '0'
import geopandas

In the next release, GeoPandas will switch to using Shapely by default, even if PyGEOS is installed. If you only have PyGEOS installed to get speed-ups, this switch should be smooth. However, if you are using PyGEOS directly (calling PyGEOS functions on geometries from GeoPandas), this will then stop working and you are encouraged to migrate from PyGEOS to Shapely 2.0 (https://shapely.readthedocs.io/en/latest/migration_pygeos.html).
  import geopandas</code></pre>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>gdf <span class="op">=</span> geopandas.read_file(<span class="st">"./data/shared/covid/gz_2010_us_040_00_500k.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>ERROR 1: PROJ: proj_create_from_database: Open of /opt/tljh/user/share/proj failed</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>gdf.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>GEO_ID</th>
      <th>STATE</th>
      <th>NAME</th>
      <th>LSAD</th>
      <th>CENSUSAREA</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0400000US23</td>
      <td>23</td>
      <td>Maine</td>
      <td></td>
      <td>30842.923</td>
      <td>MULTIPOLYGON (((-67.61976 44.51975, -67.61541 ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0400000US25</td>
      <td>25</td>
      <td>Massachusetts</td>
      <td></td>
      <td>7800.058</td>
      <td>MULTIPOLYGON (((-70.83204 41.60650, -70.82373 ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0400000US26</td>
      <td>26</td>
      <td>Michigan</td>
      <td></td>
      <td>56538.901</td>
      <td>MULTIPOLYGON (((-88.68443 48.11579, -88.67563 ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0400000US30</td>
      <td>30</td>
      <td>Montana</td>
      <td></td>
      <td>145545.801</td>
      <td>POLYGON ((-104.05770 44.99743, -104.25015 44.9...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0400000US32</td>
      <td>32</td>
      <td>Nevada</td>
      <td></td>
      <td>109781.180</td>
      <td>POLYGON ((-114.05060 37.00040, -114.04999 36.9...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>gdf.columns.values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>array(['GEO_ID', 'STATE', 'NAME', 'LSAD', 'CENSUSAREA', 'geometry'],
      dtype=object)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>gdf.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2023-09-13_files/figure-html/cell-6-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(gdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>geopandas.geodataframe.GeoDataFrame</code></pre>
</div>
</div>
<section id="geometry" class="level2">
<h2 class="anchored" data-anchor-id="geometry">Geometry</h2>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>gdf.geometry</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>0     MULTIPOLYGON (((-67.61976 44.51975, -67.61541 ...
1     MULTIPOLYGON (((-70.83204 41.60650, -70.82373 ...
2     MULTIPOLYGON (((-88.68443 48.11579, -88.67563 ...
3     POLYGON ((-104.05770 44.99743, -104.25015 44.9...
4     POLYGON ((-114.05060 37.00040, -114.04999 36.9...
5     POLYGON ((-75.52684 39.65571, -75.52634 39.656...
6     MULTIPOLYGON (((-71.94356 41.28668, -71.92680 ...
7     MULTIPOLYGON (((-82.60288 36.03983, -82.60074 ...
8     MULTIPOLYGON (((-82.81349 41.72347, -82.81049 ...
9     POLYGON ((-75.41504 39.80179, -75.42804 39.809...
10    MULTIPOLYGON (((-71.28157 41.64821, -71.27817 ...
11    POLYGON ((-81.67754 36.58812, -81.68014 36.585...
12    MULTIPOLYGON (((-97.13436 27.89633, -97.13360 ...
13    POLYGON ((-114.05060 37.00040, -114.05175 37.0...
14    MULTIPOLYGON (((-123.09055 49.00198, -123.0353...
15    MULTIPOLYGON (((-90.45525 47.02400, -90.45713 ...
16    MULTIPOLYGON (((-65.58733 18.38199, -65.59122 ...
17    MULTIPOLYGON (((-76.07147 38.20350, -76.04879 ...
18    MULTIPOLYGON (((-85.00237 31.00068, -85.02411 ...
19    MULTIPOLYGON (((-164.97620 54.13459, -164.9377...
20    POLYGON ((-109.04522 36.99908, -109.04524 36.9...
21    POLYGON ((-94.55929 36.49950, -94.51948 36.499...
22    MULTIPOLYGON (((-122.44632 37.86105, -122.4385...
23    POLYGON ((-102.04224 36.99308, -102.05450 36.9...
24    MULTIPOLYGON (((-71.85957 41.32240, -71.86823 ...
25    MULTIPOLYGON (((-75.55945 39.62981, -75.55910 ...
26    POLYGON ((-77.03860 38.79151, -77.03890 38.800...
27    MULTIPOLYGON (((-85.15641 29.67963, -85.13740 ...
28    POLYGON ((-81.44412 30.70971, -81.44872 30.709...
29    MULTIPOLYGON (((-171.73761 25.79210, -171.7223...
30    POLYGON ((-111.04669 42.00157, -111.41587 42.0...
31    POLYGON ((-87.53233 39.99778, -87.53254 39.987...
32    POLYGON ((-88.02803 37.79922, -88.02938 37.803...
33    POLYGON ((-95.76565 40.58521, -95.75889 40.588...
34    POLYGON ((-94.61808 36.99813, -94.62522 36.998...
35    MULTIPOLYGON (((-83.67541 36.60081, -83.67561 ...
36    MULTIPOLYGON (((-88.86507 29.75271, -88.88975 ...
37    POLYGON ((-91.37161 43.50095, -91.37695 43.500...
38    MULTIPOLYGON (((-88.71072 30.25080, -88.65680 ...
39    POLYGON ((-89.53910 36.49820, -89.53452 36.491...
40    POLYGON ((-95.76565 40.58521, -95.76853 40.583...
41    MULTIPOLYGON (((-72.45852 42.72685, -72.45849 ...
42    POLYGON ((-109.05004 31.33250, -109.05017 31.4...
43    POLYGON ((-96.56328 45.93524, -96.57690 45.935...
44    POLYGON ((-94.61792 36.49941, -94.61531 36.484...
45    POLYGON ((-117.22007 44.30138, -117.22245 44.2...
46    POLYGON ((-78.54109 33.85111, -78.55394 33.847...
47    POLYGON ((-96.44341 42.48949, -96.45971 42.486...
48    POLYGON ((-72.04008 44.15575, -72.04271 44.152...
49    MULTIPOLYGON (((-76.04653 37.95359, -76.04169 ...
50    POLYGON ((-81.96830 37.53780, -81.96540 37.541...
51    POLYGON ((-109.05008 41.00066, -109.17368 41.0...
Name: geometry, dtype: geometry</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>gdf.iloc[<span class="dv">0</span>].geometry</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<p><img src="2023-09-13_files/figure-html/cell-9-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>gdf.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>(52, 6)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>gdf.head(<span class="dv">52</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>GEO_ID</th>
      <th>STATE</th>
      <th>NAME</th>
      <th>LSAD</th>
      <th>CENSUSAREA</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0400000US23</td>
      <td>23</td>
      <td>Maine</td>
      <td></td>
      <td>30842.923</td>
      <td>MULTIPOLYGON (((-67.61976 44.51975, -67.61541 ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0400000US25</td>
      <td>25</td>
      <td>Massachusetts</td>
      <td></td>
      <td>7800.058</td>
      <td>MULTIPOLYGON (((-70.83204 41.60650, -70.82373 ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0400000US26</td>
      <td>26</td>
      <td>Michigan</td>
      <td></td>
      <td>56538.901</td>
      <td>MULTIPOLYGON (((-88.68443 48.11579, -88.67563 ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0400000US30</td>
      <td>30</td>
      <td>Montana</td>
      <td></td>
      <td>145545.801</td>
      <td>POLYGON ((-104.05770 44.99743, -104.25015 44.9...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0400000US32</td>
      <td>32</td>
      <td>Nevada</td>
      <td></td>
      <td>109781.180</td>
      <td>POLYGON ((-114.05060 37.00040, -114.04999 36.9...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0400000US34</td>
      <td>34</td>
      <td>New Jersey</td>
      <td></td>
      <td>7354.220</td>
      <td>POLYGON ((-75.52684 39.65571, -75.52634 39.656...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0400000US36</td>
      <td>36</td>
      <td>New York</td>
      <td></td>
      <td>47126.399</td>
      <td>MULTIPOLYGON (((-71.94356 41.28668, -71.92680 ...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0400000US37</td>
      <td>37</td>
      <td>North Carolina</td>
      <td></td>
      <td>48617.905</td>
      <td>MULTIPOLYGON (((-82.60288 36.03983, -82.60074 ...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0400000US39</td>
      <td>39</td>
      <td>Ohio</td>
      <td></td>
      <td>40860.694</td>
      <td>MULTIPOLYGON (((-82.81349 41.72347, -82.81049 ...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0400000US42</td>
      <td>42</td>
      <td>Pennsylvania</td>
      <td></td>
      <td>44742.703</td>
      <td>POLYGON ((-75.41504 39.80179, -75.42804 39.809...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0400000US44</td>
      <td>44</td>
      <td>Rhode Island</td>
      <td></td>
      <td>1033.814</td>
      <td>MULTIPOLYGON (((-71.28157 41.64821, -71.27817 ...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0400000US47</td>
      <td>47</td>
      <td>Tennessee</td>
      <td></td>
      <td>41234.896</td>
      <td>POLYGON ((-81.67754 36.58812, -81.68014 36.585...</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0400000US48</td>
      <td>48</td>
      <td>Texas</td>
      <td></td>
      <td>261231.711</td>
      <td>MULTIPOLYGON (((-97.13436 27.89633, -97.13360 ...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0400000US49</td>
      <td>49</td>
      <td>Utah</td>
      <td></td>
      <td>82169.620</td>
      <td>POLYGON ((-114.05060 37.00040, -114.05175 37.0...</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0400000US53</td>
      <td>53</td>
      <td>Washington</td>
      <td></td>
      <td>66455.521</td>
      <td>MULTIPOLYGON (((-123.09055 49.00198, -123.0353...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0400000US55</td>
      <td>55</td>
      <td>Wisconsin</td>
      <td></td>
      <td>54157.805</td>
      <td>MULTIPOLYGON (((-90.45525 47.02400, -90.45713 ...</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0400000US72</td>
      <td>72</td>
      <td>Puerto Rico</td>
      <td></td>
      <td>3423.775</td>
      <td>MULTIPOLYGON (((-65.58733 18.38199, -65.59122 ...</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0400000US24</td>
      <td>24</td>
      <td>Maryland</td>
      <td></td>
      <td>9707.241</td>
      <td>MULTIPOLYGON (((-76.07147 38.20350, -76.04879 ...</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0400000US01</td>
      <td>01</td>
      <td>Alabama</td>
      <td></td>
      <td>50645.326</td>
      <td>MULTIPOLYGON (((-85.00237 31.00068, -85.02411 ...</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0400000US02</td>
      <td>02</td>
      <td>Alaska</td>
      <td></td>
      <td>570640.950</td>
      <td>MULTIPOLYGON (((-164.97620 54.13459, -164.9377...</td>
    </tr>
    <tr>
      <th>20</th>
      <td>0400000US04</td>
      <td>04</td>
      <td>Arizona</td>
      <td></td>
      <td>113594.084</td>
      <td>POLYGON ((-109.04522 36.99908, -109.04524 36.9...</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0400000US05</td>
      <td>05</td>
      <td>Arkansas</td>
      <td></td>
      <td>52035.477</td>
      <td>POLYGON ((-94.55929 36.49950, -94.51948 36.499...</td>
    </tr>
    <tr>
      <th>22</th>
      <td>0400000US06</td>
      <td>06</td>
      <td>California</td>
      <td></td>
      <td>155779.220</td>
      <td>MULTIPOLYGON (((-122.44632 37.86105, -122.4385...</td>
    </tr>
    <tr>
      <th>23</th>
      <td>0400000US08</td>
      <td>08</td>
      <td>Colorado</td>
      <td></td>
      <td>103641.888</td>
      <td>POLYGON ((-102.04224 36.99308, -102.05450 36.9...</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0400000US09</td>
      <td>09</td>
      <td>Connecticut</td>
      <td></td>
      <td>4842.355</td>
      <td>MULTIPOLYGON (((-71.85957 41.32240, -71.86823 ...</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0400000US10</td>
      <td>10</td>
      <td>Delaware</td>
      <td></td>
      <td>1948.543</td>
      <td>MULTIPOLYGON (((-75.55945 39.62981, -75.55910 ...</td>
    </tr>
    <tr>
      <th>26</th>
      <td>0400000US11</td>
      <td>11</td>
      <td>District of Columbia</td>
      <td></td>
      <td>61.048</td>
      <td>POLYGON ((-77.03860 38.79151, -77.03890 38.800...</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0400000US12</td>
      <td>12</td>
      <td>Florida</td>
      <td></td>
      <td>53624.759</td>
      <td>MULTIPOLYGON (((-85.15641 29.67963, -85.13740 ...</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0400000US13</td>
      <td>13</td>
      <td>Georgia</td>
      <td></td>
      <td>57513.485</td>
      <td>POLYGON ((-81.44412 30.70971, -81.44872 30.709...</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0400000US15</td>
      <td>15</td>
      <td>Hawaii</td>
      <td></td>
      <td>6422.628</td>
      <td>MULTIPOLYGON (((-171.73761 25.79210, -171.7223...</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0400000US16</td>
      <td>16</td>
      <td>Idaho</td>
      <td></td>
      <td>82643.117</td>
      <td>POLYGON ((-111.04669 42.00157, -111.41587 42.0...</td>
    </tr>
    <tr>
      <th>31</th>
      <td>0400000US17</td>
      <td>17</td>
      <td>Illinois</td>
      <td></td>
      <td>55518.930</td>
      <td>POLYGON ((-87.53233 39.99778, -87.53254 39.987...</td>
    </tr>
    <tr>
      <th>32</th>
      <td>0400000US18</td>
      <td>18</td>
      <td>Indiana</td>
      <td></td>
      <td>35826.109</td>
      <td>POLYGON ((-88.02803 37.79922, -88.02938 37.803...</td>
    </tr>
    <tr>
      <th>33</th>
      <td>0400000US19</td>
      <td>19</td>
      <td>Iowa</td>
      <td></td>
      <td>55857.130</td>
      <td>POLYGON ((-95.76565 40.58521, -95.75889 40.588...</td>
    </tr>
    <tr>
      <th>34</th>
      <td>0400000US20</td>
      <td>20</td>
      <td>Kansas</td>
      <td></td>
      <td>81758.717</td>
      <td>POLYGON ((-94.61808 36.99813, -94.62522 36.998...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>0400000US21</td>
      <td>21</td>
      <td>Kentucky</td>
      <td></td>
      <td>39486.338</td>
      <td>MULTIPOLYGON (((-83.67541 36.60081, -83.67561 ...</td>
    </tr>
    <tr>
      <th>36</th>
      <td>0400000US22</td>
      <td>22</td>
      <td>Louisiana</td>
      <td></td>
      <td>43203.905</td>
      <td>MULTIPOLYGON (((-88.86507 29.75271, -88.88975 ...</td>
    </tr>
    <tr>
      <th>37</th>
      <td>0400000US27</td>
      <td>27</td>
      <td>Minnesota</td>
      <td></td>
      <td>79626.743</td>
      <td>POLYGON ((-91.37161 43.50095, -91.37695 43.500...</td>
    </tr>
    <tr>
      <th>38</th>
      <td>0400000US28</td>
      <td>28</td>
      <td>Mississippi</td>
      <td></td>
      <td>46923.274</td>
      <td>MULTIPOLYGON (((-88.71072 30.25080, -88.65680 ...</td>
    </tr>
    <tr>
      <th>39</th>
      <td>0400000US29</td>
      <td>29</td>
      <td>Missouri</td>
      <td></td>
      <td>68741.522</td>
      <td>POLYGON ((-89.53910 36.49820, -89.53452 36.491...</td>
    </tr>
    <tr>
      <th>40</th>
      <td>0400000US31</td>
      <td>31</td>
      <td>Nebraska</td>
      <td></td>
      <td>76824.171</td>
      <td>POLYGON ((-95.76565 40.58521, -95.76853 40.583...</td>
    </tr>
    <tr>
      <th>41</th>
      <td>0400000US33</td>
      <td>33</td>
      <td>New Hampshire</td>
      <td></td>
      <td>8952.651</td>
      <td>MULTIPOLYGON (((-72.45852 42.72685, -72.45849 ...</td>
    </tr>
    <tr>
      <th>42</th>
      <td>0400000US35</td>
      <td>35</td>
      <td>New Mexico</td>
      <td></td>
      <td>121298.148</td>
      <td>POLYGON ((-109.05004 31.33250, -109.05017 31.4...</td>
    </tr>
    <tr>
      <th>43</th>
      <td>0400000US38</td>
      <td>38</td>
      <td>North Dakota</td>
      <td></td>
      <td>69000.798</td>
      <td>POLYGON ((-96.56328 45.93524, -96.57690 45.935...</td>
    </tr>
    <tr>
      <th>44</th>
      <td>0400000US40</td>
      <td>40</td>
      <td>Oklahoma</td>
      <td></td>
      <td>68594.921</td>
      <td>POLYGON ((-94.61792 36.49941, -94.61531 36.484...</td>
    </tr>
    <tr>
      <th>45</th>
      <td>0400000US41</td>
      <td>41</td>
      <td>Oregon</td>
      <td></td>
      <td>95988.013</td>
      <td>POLYGON ((-117.22007 44.30138, -117.22245 44.2...</td>
    </tr>
    <tr>
      <th>46</th>
      <td>0400000US45</td>
      <td>45</td>
      <td>South Carolina</td>
      <td></td>
      <td>30060.696</td>
      <td>POLYGON ((-78.54109 33.85111, -78.55394 33.847...</td>
    </tr>
    <tr>
      <th>47</th>
      <td>0400000US46</td>
      <td>46</td>
      <td>South Dakota</td>
      <td></td>
      <td>75811.000</td>
      <td>POLYGON ((-96.44341 42.48949, -96.45971 42.486...</td>
    </tr>
    <tr>
      <th>48</th>
      <td>0400000US50</td>
      <td>50</td>
      <td>Vermont</td>
      <td></td>
      <td>9216.657</td>
      <td>POLYGON ((-72.04008 44.15575, -72.04271 44.152...</td>
    </tr>
    <tr>
      <th>49</th>
      <td>0400000US51</td>
      <td>51</td>
      <td>Virginia</td>
      <td></td>
      <td>39490.086</td>
      <td>MULTIPOLYGON (((-76.04653 37.95359, -76.04169 ...</td>
    </tr>
    <tr>
      <th>50</th>
      <td>0400000US54</td>
      <td>54</td>
      <td>West Virginia</td>
      <td></td>
      <td>24038.210</td>
      <td>POLYGON ((-81.96830 37.53780, -81.96540 37.541...</td>
    </tr>
    <tr>
      <th>51</th>
      <td>0400000US56</td>
      <td>56</td>
      <td>Wyoming</td>
      <td></td>
      <td>97093.141</td>
      <td>POLYGON ((-109.05008 41.00066, -109.17368 41.0...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>drop_states <span class="op">=</span> [<span class="st">'15'</span>, <span class="st">'02'</span>, <span class="st">'72'</span>] <span class="co"># HA, AK, PR</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>gdf[gdf.STATE.isin(drop_states)].plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2023-09-13_files/figure-html/cell-13-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>gdf[<span class="op">~</span>gdf.STATE.isin(drop_states)].plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2023-09-13_files/figure-html/cell-14-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>gdf <span class="op">=</span> gdf[<span class="op">~</span>gdf.STATE.isin(drop_states)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>gdf.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>(49, 6)</code></pre>
</div>
</div>
</section>
<section id="centroids-and-geometry" class="level2">
<h2 class="anchored" data-anchor-id="centroids-and-geometry">Centroids and geometry</h2>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>gdf.centroid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_2579345/2017122361.py:1: UserWarning: Geometry is in a geographic CRS. Results from 'centroid' are likely incorrect. Use 'GeoSeries.to_crs()' to re-project geometries to a projected CRS before this operation.

  gdf.centroid</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>0      POINT (-69.22532 45.36948)
1      POINT (-71.79546 42.25229)
2      POINT (-85.43751 44.35323)
3     POINT (-109.64507 47.03355)
4     POINT (-116.65540 39.35646)
5      POINT (-74.66099 40.18393)
6      POINT (-75.50198 42.93930)
7      POINT (-79.35542 35.53980)
8      POINT (-82.79018 40.29333)
9      POINT (-77.79953 40.87382)
10     POINT (-71.55250 41.67619)
11     POINT (-86.34329 35.84299)
12     POINT (-99.35528 31.49051)
13    POINT (-111.67820 39.32379)
14    POINT (-120.45017 47.38108)
15     POINT (-90.01113 44.63829)
17     POINT (-76.76446 39.03041)
18     POINT (-86.82843 32.78969)
20    POINT (-111.66458 34.29326)
21     POINT (-92.43928 34.89974)
22    POINT (-119.61077 37.24612)
23    POINT (-105.54782 38.99855)
24     POINT (-72.72576 41.62055)
25     POINT (-75.50018 38.99178)
26     POINT (-77.01630 38.90473)
27     POINT (-82.50162 28.64096)
28     POINT (-83.44606 32.64908)
30    POINT (-114.65933 44.38912)
31     POINT (-89.19828 40.06474)
32     POINT (-86.27529 39.90853)
33     POINT (-93.50004 42.07462)
34     POINT (-98.38022 38.48470)
35     POINT (-85.29049 37.52666)
36     POINT (-91.98048 31.05264)
37     POINT (-94.30870 46.31645)
38     POINT (-89.66510 32.75040)
39     POINT (-92.47742 38.36762)
40     POINT (-99.81080 41.52715)
41     POINT (-71.57760 43.68569)
42    POINT (-106.10838 34.42137)
43    POINT (-100.46931 47.44634)
44     POINT (-97.50844 35.58350)
45    POINT (-120.55529 43.93673)
46     POINT (-80.89550 33.90710)
47    POINT (-100.23049 44.43615)
48     POINT (-72.66272 44.07518)
49     POINT (-78.80562 37.51539)
50     POINT (-80.61385 38.64251)
51    POINT (-107.55145 42.99964)
dtype: geometry</code></pre>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>gdf.crs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>&lt;Geographic 2D CRS: EPSG:4326&gt;
Name: WGS 84
Axis Info [ellipsoidal]:
- Lat[north]: Geodetic latitude (degree)
- Lon[east]: Geodetic longitude (degree)
Area of Use:
- name: World.
- bounds: (-180.0, -90.0, 180.0, 90.0)
Datum: World Geodetic System 1984 ensemble
- Ellipsoid: WGS 84
- Prime Meridian: Greenwich</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>gdf.to_crs(gdf.estimate_utm_crs()).plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2023-09-13_files/figure-html/cell-19-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>gdf <span class="op">=</span> gdf.to_crs(gdf.estimate_utm_crs())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>gdf.centroid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>0      POINT (2359392.452 5305169.775)
1      POINT (2253174.905 4901469.336)
2      POINT (1108124.800 4935453.192)
3      POINT (-765955.563 5348067.290)
4     POINT (-1548246.254 4630302.336)
5      POINT (2065285.016 4612318.097)
6      POINT (1930049.196 4904992.641)
7      POINT (1742974.165 4021487.098)
8      POINT (1368634.294 4510266.503)
9      POINT (1784134.621 4638257.315)
10     POINT (2289313.142 4842131.086)
11     POINT (1102080.849 3988935.477)
12     POINT (-103892.519 3500028.226)
13    POINT (-1115997.209 4520861.031)
14    POINT (-1565541.918 5625943.989)
15      POINT (738620.228 4945674.977)
17     POINT (1910429.070 4447760.368)
18     POINT (1078425.172 3643488.570)
20    POINT (-1230212.721 3954699.221)
21      POINT (550933.347 3861451.888)
22    POINT (-1870826.275 4466915.330)
23     POINT (-590190.342 4392344.096)
24     POINT (2192677.610 4811150.640)
25     POINT (2020359.310 4464239.060)
26     POINT (1889584.643 4429716.358)
27     POINT (1535090.511 3210901.406)
28     POINT (1399285.825 3651528.582)
30    POINT (-1223231.299 5144300.473)
31      POINT (824539.285 4439350.669)
32     POINT (1074696.801 4437810.568)
33      POINT (458939.639 4658274.632)
34       POINT (29865.949 4274404.492)
35     POINT (1181577.693 4182456.487)
36      POINT (598555.176 3435096.661)
37      POINT (399444.786 5126179.145)
38      POINT (812334.714 3626923.994)
39      POINT (547395.056 4245527.933)
40      POINT (-68074.613 4621136.163)
41     POINT (2227578.113 5064712.956)
42     POINT (-710483.211 3886170.809)
43      POINT (-63437.281 5282398.408)
44       POINT (91977.904 3947894.482)
45    POINT (-1716081.976 5249621.330)
46     POINT (1623336.735 3818285.055)
47      POINT (-76107.494 4946849.414)
48     POINT (2128860.270 5085004.659)
49     POINT (1758189.886 4249101.361)
50     POINT (1579306.753 4350654.685)
51     POINT (-688676.799 4864507.482)
dtype: geometry</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>gdf.crs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>&lt;Projected CRS: EPSG:32615&gt;
Name: WGS 84 / UTM zone 15N
Axis Info [cartesian]:
- E[east]: Easting (metre)
- N[north]: Northing (metre)
Area of Use:
- name: Between 96°W and 90°W, northern hemisphere between equator and 84°N, onshore and offshore. Canada - Manitoba; Nunavut; Ontario. Ecuador -Galapagos. Guatemala. Mexico. United States (USA).
- bounds: (-96.0, 0.0, -90.0, 84.0)
Coordinate Operation:
- name: UTM zone 15N
- method: Transverse Mercator
Datum: World Geodetic System 1984 ensemble
- Ellipsoid: WGS 84
- Prime Meridian: Greenwich</code></pre>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>gdf[<span class="st">'centroid'</span>] <span class="op">=</span> gdf.centroid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>base <span class="op">=</span> gdf.plot()</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>gdf.centroid.plot(ax<span class="op">=</span>base, color<span class="op">=</span><span class="st">'r'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2023-09-13_files/figure-html/cell-24-output-2.png" class="img-fluid"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>